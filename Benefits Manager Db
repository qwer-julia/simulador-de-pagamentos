-- Database: BenefitsManager

-- DROP DATABASE IF EXISTS "BenefitsManager";

CREATE DATABASE "BenefitsManager"
    WITH
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'English_United States.1252'
    LC_CTYPE = 'English_United States.1252'
    LOCALE_PROVIDER = 'libc'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1
    IS_TEMPLATE = False;

-- SCHEMA: public

-- DROP SCHEMA IF EXISTS public ;

CREATE SCHEMA IF NOT EXISTS public
    AUTHORIZATION pg_database_owner;

COMMENT ON SCHEMA public
    IS 'standard public schema';

GRANT USAGE ON SCHEMA public TO PUBLIC;

GRANT ALL ON SCHEMA public TO pg_database_owner;

-- SEQUENCE: public.Benefits_Id_seq

-- DROP SEQUENCE IF EXISTS public."Benefits_Id_seq";

CREATE SEQUENCE IF NOT EXISTS public."Benefits_Id_seq"
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 2147483647
    CACHE 1;

ALTER SEQUENCE public."Benefits_Id_seq"
    OWNER TO postgres;

-- SEQUENCE: public.Taxpayers_Id_seq

-- DROP SEQUENCE IF EXISTS public."Taxpayers_Id_seq";

CREATE SEQUENCE IF NOT EXISTS public."Taxpayers_Id_seq"
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 2147483647
    CACHE 1;

ALTER SEQUENCE public."Taxpayers_Id_seq"
    OWNER TO postgres;

-- Table: public.Benefits

-- DROP TABLE IF EXISTS public."Benefits";

CREATE TABLE IF NOT EXISTS public."Benefits"
(
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "Name" text COLLATE pg_catalog."default" NOT NULL,
    "DiscountPercentage" real NOT NULL,
    CONSTRAINT "PK_Benefits" PRIMARY KEY ("Id")
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public."Benefits"
    OWNER to postgres;

-- Table: public.Taxpayers

-- DROP TABLE IF EXISTS public."Taxpayers";

CREATE TABLE IF NOT EXISTS public."Taxpayers"
(
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "Cnpj" bigint NOT NULL,
    "CompanyName" text COLLATE pg_catalog."default" NOT NULL,
    "OpeningDate" date NOT NULL,
    "TaxationRegime" text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT "PK_Taxpayers" PRIMARY KEY ("Id")
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public."Taxpayers"
    OWNER to postgres;

-- Index: IX_Taxpayers_Cnpj

-- DROP INDEX IF EXISTS public."IX_Taxpayers_Cnpj";

CREATE UNIQUE INDEX IF NOT EXISTS "IX_Taxpayers_Cnpj"
    ON public."Taxpayers" USING btree
    ("Cnpj" ASC NULLS LAST)
    TABLESPACE pg_default;

-- Table: public.TaxpayerBenefits

-- DROP TABLE IF EXISTS public."TaxpayerBenefits";

CREATE TABLE IF NOT EXISTS public."TaxpayerBenefits"
(
    "TaxpayerId" integer NOT NULL,
    "BenefitId" integer NOT NULL,
    CONSTRAINT "PK_TaxpayerBenefits" PRIMARY KEY ("TaxpayerId", "BenefitId"),
    CONSTRAINT "FK_TaxpayerBenefits_Benefits_BenefitId" FOREIGN KEY ("BenefitId")
        REFERENCES public."Benefits" ("Id") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE CASCADE,
    CONSTRAINT "FK_TaxpayerBenefits_Taxpayers_TaxpayerId" FOREIGN KEY ("TaxpayerId")
        REFERENCES public."Taxpayers" ("Id") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE CASCADE
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS public."TaxpayerBenefits"
    OWNER to postgres;

-- Index: IX_TaxpayerBenefits_BenefitId

-- DROP INDEX IF EXISTS public."IX_TaxpayerBenefits_BenefitId";

CREATE INDEX IF NOT EXISTS "IX_TaxpayerBenefits_BenefitId"
    ON public."TaxpayerBenefits" USING btree
    ("BenefitId" ASC NULLS LAST)
    TABLESPACE pg_default;
